-- 1)

CREATE TABLE IF NOT EXISTS `addresses` (
    `address_id` INT NOT NULL AUTO_INCREMENT,
    `country` VARCHAR(100) NOT NULL,
    `city` VARCHAR(100) NOT NULL,
    `zip_code` VARCHAR(20) NOT NULL,
    `street` VARCHAR(100) NOT NULL,
    `house_number` VARCHAR(20) NOT NULL,
    `bus_number` VARCHAR(20),
    `address_description` TEXT,
    PRIMARY KEY (`address_id`)
) ENGINE=INNODB DEFAULT CHARSET=latin1;


CREATE TABLE IF NOT EXISTS `users` (
    `user_id` INT NOT NULL AUTO_INCREMENT,
    `address_id` INT,
    `user_type` ENUM('admin', 'user') NOT NULL,
    `account_status` ENUM('active', 'inactive') NOT NULL,
    `first_name` VARCHAR(100) NOT NULL,
    `last_name` VARCHAR(100) NOT NULL,
    `birth_date` DATE NOT NULL,
    `email` VARCHAR(100) NOT NULL,
    `pwd` VARBINARY(64) NOT NULL,  -- Adjust the length based on your hash algorithm (e.g., SHA-256)
    `phone_number` VARCHAR(100) NOT NULL,
    PRIMARY KEY (`user_id`),
    FOREIGN KEY (`address_id`) REFERENCES `addresses`(`address_id`) ON DELETE CASCADE
) ENGINE=INNODB DEFAULT CHARSET=latin1;

CREATE TABLE IF NOT EXISTS `payments` (
    `payment_id` INT NOT NULL AUTO_INCREMENT,
    `method` VARCHAR(100) NOT NULL,
    `payment_date` DATE NOT NULL,
    `payment_status` ENUM('paid', 'failed') NOT NULL,
    `total_price` DECIMAL(10, 2) NOT NULL,
    PRIMARY KEY (`payment_id`)
) ENGINE=INNODB DEFAULT CHARSET=latin1;

CREATE TABLE IF NOT EXISTS `orders` (
    `order_id` INT NOT NULL AUTO_INCREMENT,
    `user_id` INT,
    `payment_id` INT,
    `order_date` DATE NOT NULL,
    `delivery_date` DATE,
    `order_status` ENUM('pending', 'processing', 'shipped', 'delivered', 'cancelled') NOT NULL,
    `delivery_notes` TEXT,
    PRIMARY KEY (`order_id`),
    FOREIGN KEY (`user_id`) REFERENCES `users`(`user_id`) ON DELETE SET NULL,
    FOREIGN KEY (`payment_id`) REFERENCES `payments`(`payment_id`) ON DELETE SET NULL
) ENGINE=INNODB DEFAULT CHARSET=latin1;



CREATE TABLE IF NOT EXISTS `categories` (
    `category_id` INT NOT NULL AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL,
    PRIMARY KEY (`category_id`)
) ENGINE=INNODB DEFAULT CHARSET=latin1;



CREATE TABLE IF NOT EXISTS `products` (
    `product_id` INT NOT NULL AUTO_INCREMENT,
    `category_id` INT,
    `name` VARCHAR(100) NOT NULL,
    `price` DECIMAL(10, 2) NOT NULL,
    `amount_left` INT NOT NULL,
    `is_active` BOOLEAN NOT NULL,
    `product_image` VARCHAR(255),
    PRIMARY KEY (`product_id`),
    FOREIGN KEY (`category_id`) REFERENCES `categories`(`category_id`) ON DELETE SET NULL
) ENGINE=INNODB DEFAULT CHARSET=latin1;



CREATE TABLE IF NOT EXISTS `orders_products` (
    `orders_products_id` INT NOT NULL AUTO_INCREMENT,
    `order_id` INT NOT NULL,
    `product_id` INT NOT NULL,
    `product_amount` INT NOT NULL,
    `subtotal` DECIMAL(10, 2) NOT NULL,
    PRIMARY KEY (`orders_products_id`),
    FOREIGN KEY (`order_id`) REFERENCES `orders`(`order_id`) ON DELETE CASCADE,
    FOREIGN KEY (`product_id`) REFERENCES `products`(`product_id`) ON DELETE CASCADE
) ENGINE=INNODB DEFAULT CHARSET=latin1;



----------------------------------------------------


-- 2)

INSERT INTO `categories` (`name`) VALUES ('Camp Chair');
INSERT INTO `categories` (`name`) VALUES ('Coffee Mug');
INSERT INTO `categories` (`name`) VALUES ('Camp Stove');
INSERT INTO `categories` (`name`) VALUES ('Pocket Knife');
INSERT INTO `categories` (`name`) VALUES ('Lantern');
INSERT INTO `categories` (`name`) VALUES ('Rooftop Tent');
INSERT INTO `categories` (`name`) VALUES ('Tent');
INSERT INTO `categories` (`name`) VALUES ('Moka Pot');



-----------------------------------------------------


-- 3)

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Green Chair', 29.99, 29, true, 'chair-green.jpg'
FROM `categories`
WHERE `name` = 'Camp Chair';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Green Red', 29.99, 29, true, 'chair-red.jpg'
FROM `categories`
WHERE `name` = 'Camp Chair';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Green Red', 29.99, 29, true, 'chairs.jpg'
FROM `categories`
WHERE `name` = 'Camp Chair';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Colored Coffee Mug', 32.99, 29, true, 'coffee-mug-colored.jpg'
FROM `categories`
WHERE `name` = 'Coffee Mug';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Grey Coffee Mug', 32.99, 29, true, 'coffee-mug-grey.jpg'
FROM `categories`
WHERE `name` = 'Coffee Mug';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Wooden Coffee Mug', 32.99, 29, true, 'coffee-mug-wooden.jpg'
FROM `categories`
WHERE `name` = 'Coffee Mug';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Double Stove 1', 42.99, 29, true, 'double-stove1.jpg'
FROM `categories`
WHERE `name` = 'Camp Stove';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Double Stove 2', 42.99, 29, true, 'double-stove2.jpg'
FROM `categories`
WHERE `name` = 'Camp Stove';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Stove Large', 39.99, 29, true, 'stove-large.jpg'
FROM `categories`
WHERE `name` = 'Camp Stove';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Stove Small', 33.99, 29, true, 'stove-small.jpg'
FROM `categories`
WHERE `name` = 'Camp Stove';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Green Tent', 44.99, 29, true, 'tent-green.jpg'
FROM `categories`
WHERE `name` = 'Tent';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Orange Tent', 44.99, 29, true, 'tent-orange.jpg'
FROM `categories`
WHERE `name` = 'Tent';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Yellow Tent', 44.99, 29, true, 'tent-yellow.jpg'
FROM `categories`
WHERE `name` = 'Tent';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Knife Black', 25.99, 29, true, 'knife1.jpg'
FROM `categories`
WHERE `name` = 'Pocket Knife';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Knife Brown', 25.99, 29, true, 'knife2.jpg'
FROM `categories`
WHERE `name` = 'Pocket Knife';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Lantern Silver', 25.99, 29, true, 'lantern1.jpg'
FROM `categories`
WHERE `name` = 'Lantern';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Lantern Black', 25.99, 29, true, 'lantern2.jpg'
FROM `categories`
WHERE `name` = 'Lantern';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Moka Pot', 25.99, 29, true, 'moka.jpg'
FROM `categories`
WHERE `name` = 'Moka Pot';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Moka Pot Small', 21.99, 29, true, 'moka-small.jpg'
FROM `categories`
WHERE `name` = 'Moka Pot';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Moka Pot Large', 29.99, 29, true, 'moka-large.jpg'
FROM `categories`
WHERE `name` = 'Moka Pot';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Rooftop Tent Orange', 109.99, 29, true, 'rooftop-tent1.jpg'
FROM `categories`
WHERE `name` = 'Rooftop Tent';

INSERT INTO `products` (`category_id`, `name`, `price`, `amount_left`, `is_active`, `product_image`)
SELECT `category_id`, 'Rooftop Tent White', 109.99, 29, true, 'rooftop-tent2.jpg'
FROM `categories`
WHERE `name` = 'Rooftop Tent';

INSERT INTO `users` (`user_type`, `account_status`, `first_name`, `last_name`, `birth_date`, `email`, `pwd`) VALUES ('admin', 'active', 'admin', 'admin', '12-12-1912', 'admin@local.test', '$2y$10$q8CR6/2sbd5lPBawbV2rn.Gk8vl5t8zv0KV3tAu3N/JLsB6gd8Jvu');